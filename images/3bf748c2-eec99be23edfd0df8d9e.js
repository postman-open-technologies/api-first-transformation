"use strict";(self.webpackChunkpostman_marketing_site=self.webpackChunkpostman_marketing_site||[]).push([[453],{26926:function(e,t,n){n.d(t,{Z:function(){return xt}});n(65743),n(55674);var i=n(57345),o=n(2836),r=n.n(o),s=n(32203),a=n(59551),u=n.n(a),c=n(17852),p=n(62426).Buffer;function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){v(e,t,n[t])}))}return e}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var m="$default_instance",_=2,I=4096,b=1e3,S="$identify",k="$groupidentify",E="api.amplitude.com",O="api.eu.amplitude.com",w="regionconfig.amplitude.com",C="regionconfig.eu.amplitude.com",N=0,A=1,D=2,P=3,q=4,x=5,T=6,R=7,U="amp_cookie_test",j="amp",K="",M="cookies",G="none",W="localStorage",L="sessionStorage",B="revenue_amount",F="$productId",$="$quantity",J="$price",z="$revenueType",V="amp_device_id",Z="referrer",X="utm_source",H="utm_medium",Q="utm_campaign",Y="utm_term",ee="utm_content",te="[Amplitude] Attribution Captured",ne="http",ie="beacon",oe=function(e){for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},re=function(e){for(var t="",n=0,i=0,o=0,r=0;n<e.length;)(i=e.charCodeAt(n))<128?(t+=String.fromCharCode(i),n++):i>191&&i<224?(o=e.charCodeAt(n+1),t+=String.fromCharCode((31&i)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),r=e.charCodeAt(n+2),t+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&r),n+=3);return t},se="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:void 0,ae={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){try{if(se.btoa&&se.atob)return se.btoa(unescape(encodeURIComponent(e)))}catch(t){}return ae._encode(e)},_encode:function(e){var t,n,i,o,r,s,a,u="",c=0;for(e=oe(e);c<e.length;)o=(t=e.charCodeAt(c++))>>2,r=(3&t)<<4|(n=e.charCodeAt(c++))>>4,s=(15&n)<<2|(i=e.charCodeAt(c++))>>6,a=63&i,isNaN(n)?s=a=64:isNaN(i)&&(a=64),u=u+ae._keyStr.charAt(o)+ae._keyStr.charAt(r)+ae._keyStr.charAt(s)+ae._keyStr.charAt(a);return u},decode:function(e){try{if(se.btoa&&se.atob)return decodeURIComponent(escape(se.atob(e)))}catch(t){}return ae._decode(e)},_decode:function(e){var t,n,i,o,r,s,a="",u=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");u<e.length;)t=ae._keyStr.indexOf(e.charAt(u++))<<2|(o=ae._keyStr.indexOf(e.charAt(u++)))>>4,n=(15&o)<<4|(r=ae._keyStr.indexOf(e.charAt(u++)))>>2,i=(3&r)<<6|(s=ae._keyStr.indexOf(e.charAt(u++))),a+=String.fromCharCode(t),64!==r&&(a+=String.fromCharCode(n)),64!==s&&(a+=String.fromCharCode(i));return a=re(a)}},ue=Object.prototype.toString;function ce(e){switch(ue.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!=e?"nan":e&&1===e.nodeType?"element":void 0!==p&&"function"==typeof p.isBuffer&&p.isBuffer(e)?"buffer":l(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e))}var pe,le={DISABLE:0,ERROR:1,WARN:2,INFO:3},he=le.WARN,de={error:function(e){he>=le.ERROR&&fe(e)},warn:function(e){he>=le.WARN&&fe(e)},info:function(e){he>=le.INFO&&fe(e)}},fe=function(e){try{console.log("[Amplitude] "+e)}catch(t){}},ve=function(e){return"string"===ce(e)&&e.length>I?e.substring(0,I):e},ye=function(e,t,n){return ce(e)===n||(de.error("Invalid "+t+" input type. Expected "+n+" but received "+ce(e)),!1)},ge=function(e){var t=ce(e);if("object"!==t)return de.error("Error: invalid properties format. Expecting Javascript object, received "+t+", ignoring"),{};if(Object.keys(e).length>b)return de.error("Error: too many properties (more than 1000), ignoring"),{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=i,r=ce(o);"string"!==r&&(o=String(o),de.warn("WARNING: Non-string property key, received type "+r+', coercing to string "'+o+'"'));var s=_e(o,e[i]);null!==s&&(n[o]=s)}return n},me=["nan","function","arguments","regexp","element"],_e=function e(t,n){var i=ce(n);if(-1!==me.indexOf(i))de.warn('WARNING: Property key "'+t+'" with invalid value type '+i+", ignoring"),n=null;else if("undefined"===i)n=null;else if("error"===i)n=String(n),de.warn('WARNING: Property key "'+t+'" with value type error, coercing to '+n);else if("array"===i){for(var o=[],r=0;r<n.length;r++){var s=n[r],a=ce(s);"array"!==a?"object"===a?o.push(ge(s)):o.push(e(t,s)):de.warn("WARNING: Cannot have "+a+" nested in an array property value, skipping")}n=o}else"object"===i&&(n=ge(n));return n},Ie=function(e,t){var n=ce(t);if("string"===n)return t;if("date"===n||"number"===n||"boolean"===n)return t=String(t),de.warn("WARNING: Non-string groupName, received type "+n+', coercing to string "'+t+'"'),t;if("array"===n){for(var i=[],o=0;o<t.length;o++){var r=t[o],s=ce(r);"array"!==s&&"object"!==s?"string"===s?i.push(r):"date"!==s&&"number"!==s&&"boolean"!==s||(r=String(r),de.warn("WARNING: Non-string groupName, received type "+s+', coercing to string "'+r+'"'),i.push(r)):de.warn("WARNING: Skipping nested "+s+" in array groupName")}return i}de.warn("WARNING: Non-string groupName, received type "+n+". Please use strings or array of strings for groupName")},be=function(e){Object.prototype.hasOwnProperty.call(le,e)&&(he=le[e])},Se=de,ke=function(e){return!e||0===e.length},Ee=function(){return"undefined"!=typeof WorkerGlobalScope},Oe=function(e,t){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===n?void 0:decodeURIComponent(n[1].replace(/\+/g," "))},we=function e(t){if("array"===ce(t))for(var n=0;n<t.length;n++)t[n]=e(t[n]);else if("object"===ce(t))for(var i in t)i in t&&(t[i]=e(t[i]));else t=ve(t);return t},Ce=function(e){var t=ce(e);if("object"!==t)return de.error("Error: invalid groups format. Expecting Javascript object, received "+t+", ignoring"),{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=i,r=ce(o);"string"!==r&&(o=String(o),de.warn("WARNING: Non-string groupType, received type "+r+', coercing to string "'+o+'"'));var s=Ie(o,e[i]);null!==s&&(n[o]=s)}return n},Ne=ye,Ae=ge,De=function(e){return!!ye(e,"deviceId","string")&&(!e.includes(".")||(de.error("Device IDs may not contain '.' characters. Value will be ignored: \"".concat(e,'"')),!1))},Pe=function(e){return!!ye(e,"transport","string")&&(e!==ne&&e!==ie?(de.error("transport value must be one of '".concat(ie,"' or '").concat(ne,"'")),!1):!(e!==ne&&!navigator.sendBeacon)||(de.error("browser does not support sendBeacon, so transport must be HTTP"),!1))},qe=function(e){return!!(ye(e,"sessionId","number")&&new Date(e).getTime()>0)||(de.error("sessionId value must in milliseconds since epoch (Unix Timestamp)"),!1)},xe=function(){return se.location},Te=function(){for(var e="",t=0;t<22;++t)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(Math.floor(64*Math.random()));return e},Re=function(e){try{for(var t=document.cookie.split(";"),n=null,i=0;i<t.length;i++){for(var o=t[i];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e)){n=o.substring(e.length,o.length);break}}return n}catch(r){return null}},Ue=function(e,t,n){var i=null!==t?n.expirationDays:-1;if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),i=o}var r=e+"="+t;i&&(r+="; expires="+i.toUTCString()),r+="; path=/",n.domain&&(r+="; domain="+n.domain),n.secure&&(r+="; Secure"),n.sameSite&&(r+="; SameSite="+n.sameSite),document.cookie=r},je=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.split(".")[q];return n&&(e=parseInt(n,32)),e||(Se.warn("unable to parse malformed cookie: ".concat(t)),0)},Ke=Ue,Me=Re,Ge=function(e){try{var t=document.cookie.split(";").map((function(e){return e.trimStart()})),n=[],i=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){for(var u=s.value;" "===u.charAt(0);)u=u.substring(1);0===u.indexOf(e)&&n.push(u.substring(e.length))}}catch(c){o=!0,r=c}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}catch(p){return[]}},We=function(e){return g(e).sort((function(e,t){var n=je(e);return je(t)-n}))},Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=U+Te();if("undefined"==typeof document)return!1;var n=!1;try{var i=String(Date.now());Ue(t,i,e),Se.info("Testing if cookies available"),n=Re(t+"=")===i}catch(o){Se.warn('Error thrown when checking for cookies. Reason: "'.concat(o,'"'))}finally{Se.info("Cleaning up cookies availability test"),Ue(t,null,e)}return n},Be=function(e){if(e){if("undefined"!=typeof document){var t=document.createElement("a");return t.href=e,t.hostname||se.location.hostname}if("function"==typeof URL)return new URL(e).hostname||se.location.hostname}return se.location.hostname},Fe=function(e){var t=Be(e).split("."),n=[],i="_tldtest_"+Te();if(Ee())return"";for(var o=t.length-2;o>=0;--o)n.push(t.slice(o).join("."));for(var r=0;r<n.length;++r){var s=n[r],a={domain:"."+s};if(Ke(i,1,a),Me(i))return Ke(i,null,a),s}return""},$e={expirationDays:void 0,domain:void 0},Je=function(e){var t="";return $e.domain&&(t="."===$e.domain.charAt(0)?$e.domain.substring(1):$e.domain),e+t},ze=function(e){var t=Je(e)+"=",n=Me(t);try{if(n)return JSON.parse(ae.decode(n))}catch(i){return null}return null},Ve=function(e,t){try{return Ke(Je(e),ae.encode(JSON.stringify(t)),$e),!0}catch(n){return!1}},Ze=function(e){try{return Ke(Je(e),null,$e),!0}catch(t){return!1}},Xe={reset:function(){$e={expirationDays:void 0,domain:void 0}},options:function(e){if(0===arguments.length)return $e;e=e||{},$e.expirationDays=e.expirationDays,$e.secure=e.secure,$e.sameSite=e.sameSite;var t=ke(e.domain)?"."+Fe(xe().href):e.domain,n=Math.random();$e.domain=t,Ve("amplitude_test",n);var i=ze("amplitude_test");return i&&i===n||(t=null),Ze("amplitude_test"),$e.domain=t,$e},get:ze,set:Ve,remove:Ze,setRaw:function(e,t){try{return Ke(Je(e),t,$e),!0}catch(n){return!1}},getRaw:function(e){var t=Je(e)+"=";return Me(t)}},He=function(){function e(){h(this,e),this.map=new Map,this.length=0}return f(e,[{key:"key",value:function(e){var t=Array.from(this.map.keys())[e];return this.map.get(t)}},{key:"getItem",value:function(e){return this.map.get(e)}},{key:"setItem",value:function(e,t){this.map.has(e)||(this.length+=1),this.map.set(e,t)}},{key:"removeItem",value:function(e){this.map.has(e)&&(this.length-=1,this.map.delete(e))}},{key:"clear",value:function(){this.map.clear(),this.length=0}}]),e}();if(function(){var e,t=new Date;try{return se.localStorage.setItem(t,t),e=se.localStorage.getItem(t)===String(t),se.localStorage.removeItem(t),e}catch(n){}return!1}())pe=se.localStorage;else if(void 0!==se&&se.globalStorage)try{pe=se.globalStorage[se.location.hostname]}catch(Rt){}else if("undefined"!=typeof document){var Qe=document.createElement("div"),Ye="localStorage";Qe.style.display="none",document.getElementsByTagName("head")[0].appendChild(Qe),Qe.addBehavior&&(Qe.addBehavior("#default#userdata"),pe={length:0,setItem:function(e,t){Qe.load(Ye),Qe.getAttribute(e)||this.length++,Qe.setAttribute(e,t),Qe.save(Ye)},getItem:function(e){return Qe.load(Ye),Qe.getAttribute(e)},removeItem:function(e){Qe.load(Ye),Qe.getAttribute(e)&&this.length--,Qe.removeAttribute(e),Qe.save(Ye)},clear:function(){Qe.load(Ye);for(var e,t=0;e=Qe.XMLDocument.documentElement.attributes[t++];)Qe.removeAttribute(e.name);Qe.save(Ye),this.length=0},key:function(e){return Qe.load(Ye),Qe.XMLDocument.documentElement.attributes[e]}},Qe.load(Ye),pe.length=Qe.XMLDocument.documentElement.attributes.length)}else Ee()&&(pe=new He);pe||(pe={length:0,setItem:function(e,t){},getItem:function(e){},removeItem:function(e){},clear:function(){},key:function(e){}});var et,tt=pe,nt=function(){this.storage=null};nt.prototype.getStorage=function(){if(null!==this.storage)return this.storage;if(Le())this.storage=Xe;else{var e="amp_cookiestore_";this.storage={_options:{expirationDays:void 0,domain:void 0,secure:!1},reset:function(){this._options={expirationDays:void 0,domain:void 0,secure:!1}},options:function(e){return 0===arguments.length?this._options:(e=e||{},this._options.expirationDays=e.expirationDays||this._options.expirationDays,this._options.domain=e.domain||this._options.domain||se&&se.location&&se.location.hostname,this._options.secure=e.secure||!1)},get:function(t){try{return JSON.parse(tt.getItem(e+t))}catch(Rt){}return null},set:function(t,n){try{return tt.setItem(e+t,JSON.stringify(n)),!0}catch(Rt){}return!1},remove:function(t){try{tt.removeItem(e+t)}catch(Rt){return!1}}}}return this.storage};var it=(v(et={},M,!0),v(et,G,!0),v(et,W,!0),v(et,L,!0),et),ot=function(){function e(t){var n=t.storageKey,i=t.disableCookies,o=t.domain,r=t.secure,s=t.sameSite,a=t.expirationDays,u=t.storage;h(this,e),this.storageKey=n,this.domain=o,this.secure=r,this.sameSite=s,this.expirationDays=a,this.cookieDomain="";var c=Fe(xe().href);if(this.cookieDomain=o||(c?"."+c:null),it[u])this.storage=u;else{var p=i||!Le({domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays});this.storage=p?W:M}}return f(e,[{key:"getCookieStorageKey",value:function(){if(!this.domain)return this.storageKey;var e="."===this.domain.charAt(0)?this.domain.substring(1):this.domain;return"".concat(this.storageKey).concat(e?"_".concat(e):"")}},{key:"save",value:function(e){var t=e.deviceId,n=e.userId,i=e.optOut,o=e.sessionId,r=e.lastEventTime,s=e.eventId,a=e.identifyId,u=e.sequenceNumber;if(this.storage!==G){var c=[t,ae.encode(n||""),i?"1":"",o?o.toString(32):"0",r?r.toString(32):"0",s?s.toString(32):"0",a?a.toString(32):"0",u?u.toString(32):"0"].join(".");switch(this.storage){case L:se.sessionStorage&&se.sessionStorage.setItem(this.storageKey,c);break;case W:tt.setItem(this.storageKey,c);break;case M:this.saveCookie(c)}}}},{key:"saveCookie",value:function(e){Ke(this.getCookieStorageKey(),e,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays})}},{key:"load",value:function(){var e,t=this;if(this.storage===M){var n=this.getCookieStorageKey()+"=",i=Ge(n);if(0===i.length||1===i.length)e=i[0];else{var o=We(i)[0];i.forEach((function(){return Ke(t.getCookieStorageKey(),null,{})})),this.saveCookie(o),e=Me(n)}}if(e||(e=tt.getItem(this.storageKey)),!e)try{e=se.sessionStorage&&se.sessionStorage.getItem(this.storageKey)}catch(Rt){Se.info('window.sessionStorage unavailable. Reason: "'.concat(Rt,'"'))}if(!e)return null;var r=e.split("."),s=null;if(r[A])try{s=ae.decode(r[A])}catch(Rt){s=null}return{deviceId:r[N],userId:s,optOut:"1"===r[D],sessionId:parseInt(r[P],32),lastEventTime:parseInt(r[q],32),eventId:parseInt(r[x],32),identifyId:parseInt(r[T],32),sequenceNumber:parseInt(r[R],32)}}},{key:"clear",value:function(){var e;if(this.storage===M&&(e=Me(this.getCookieStorageKey()+"="),Ke(this.getCookieStorageKey(),null,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:0})),e||(e=tt.getItem(this.storageKey),tt.clear()),!e)try{e=se.sessionStorage&&se.sessionStorage.getItem(this.storageKey),se.sessionStorage.clear()}catch(Rt){Se.info('window.sessionStorage unavailable. Reason: "'.concat(Rt,'"'))}return!!e}}]),e}(),rt="$clearAll",st=function(){this.userPropertiesOperations={},this.properties=[]};st.prototype.add=function(e,t){return"number"===ce(t)||"string"===ce(t)?this._addOperation("$add",e,t):Se.error("Unsupported type for value: "+ce(t)+", expecting number or string"),this},st.prototype.append=function(e,t){return this._addOperation("$append",e,t),this},st.prototype.clearAll=function(){return Object.keys(this.userPropertiesOperations).length>0?(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,rt)||Se.error("Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll"),this):(this.userPropertiesOperations[rt]="-",this)},st.prototype.prepend=function(e,t){return this._addOperation("$prepend",e,t),this},st.prototype.set=function(e,t){return this._addOperation("$set",e,t),this},st.prototype.setOnce=function(e,t){return this._addOperation("$setOnce",e,t),this},st.prototype.unset=function(e){return this._addOperation("$unset",e,"-"),this},st.prototype.preInsert=function(e,t){return this._addOperation("$preInsert",e,t),this},st.prototype.postInsert=function(e,t){return this._addOperation("$postInsert",e,t),this},st.prototype.remove=function(e,t){return this._addOperation("$remove",e,t),this},st.prototype._addOperation=function(e,t,n){Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,rt)?Se.error("This identify already contains a $clearAll operation, skipping operation "+e):-1===this.properties.indexOf(t)?(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,e)||(this.userPropertiesOperations[e]={}),this.userPropertiesOperations[e][t]=n,this.properties.push(t)):Se.error('User property "'+t+'" already used in this identify, skipping operation '+e)};var at=function(e,t,n){this.url=e,this.data=t||{},this.headers=n};at.prototype.send=function(e){if(!!se.XDomainRequest){var t=new se.XDomainRequest;t.open("POST",this.url,!0),t.onload=function(){e(200,t.responseText)},t.onerror=function(){"Request Entity Too Large"===t.responseText?e(413,t.responseText):e(500,t.responseText)},t.ontimeout=function(){},t.onprogress=function(){},t.send(s.stringify(this.data))}else if("undefined"!=typeof XMLHttpRequest){var n=new XMLHttpRequest;n.open("POST",this.url,!0),n.onreadystatechange=function(){4===n.readyState&&e(n.status,n.responseText)},function(e,t){for(var n in t)("Cross-Origin-Resource-Policy"!==n||t[n])&&e.setRequestHeader(n,t[n])}(n,this.headers),n.send(s.stringify(this.data))}else{var i=void 0;fetch(this.url,{method:"POST",headers:this.headers,body:s.stringify(this.data)}).then((function(e){return i=e.status,e.text()})).then((function(t){e(i,t)}))}};var ut=function(){this._price=null,this._productId=null,this._quantity=1,this._revenueType=null,this._properties=null};ut.prototype.setProductId=function(e){return"string"!==ce(e)?Se.error("Unsupported type for productId: "+ce(e)+", expecting string"):ke(e)?Se.error("Invalid empty productId"):this._productId=e,this},ut.prototype.setQuantity=function(e){return"number"!==ce(e)?Se.error("Unsupported type for quantity: "+ce(e)+", expecting number"):this._quantity=parseInt(e),this},ut.prototype.setPrice=function(e){return"number"!==ce(e)?Se.error("Unsupported type for price: "+ce(e)+", expecting number"):this._price=e,this},ut.prototype.setRevenueType=function(e){return"string"!==ce(e)?Se.error("Unsupported type for revenueType: "+ce(e)+", expecting string"):this._revenueType=e,this},ut.prototype.setEventProperties=function(e){return"object"!==ce(e)?Se.error("Unsupported type for eventProperties: "+ce(e)+", expecting object"):this._properties=Ae(e),this},ut.prototype._isValidRevenue=function(){return"number"===ce(this._price)||(Se.error("Invalid revenue, need to set price field"),!1)},ut.prototype._toJSONObject=function(){var e="object"===ce(this._properties)?this._properties:{};return null!==this._productId&&(e[F]=this._productId),null!==this._quantity&&(e[$]=this._quantity),null!==this._price&&(e[J]=this._price),null!==this._revenueType&&(e[z]=this._revenueType),e};var ct=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},pt="US",lt="EU",ht=function(e){var t=E;switch(e){case lt:t=O;break;case pt:t=E}return t},dt="8.17.0",ft={apiEndpoint:E,batchEvents:!1,cookieExpiration:365,cookieName:"amplitude_id",sameSiteCookie:"Lax",cookieForceUpgrade:!1,deferInitialization:!1,disableCookies:!1,deviceIdFromUrlParam:!1,domain:"",eventUploadPeriodMillis:3e4,eventUploadThreshold:30,forceHttps:!0,includeFbclid:!1,includeGclid:!1,includeReferrer:!1,includeUtm:!1,language:function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||""}(),library:{name:"amplitude-js",version:dt},logLevel:"WARN",logAttributionCapturedEvent:!1,optOut:!1,onError:function(){},onExitPage:function(){},onNewSessionStart:function(){},plan:{branch:"",source:"",version:""},platform:"Web",savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:18e5,storage:K,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},transport:ne,unsetParamsReferrerOnNewSession:!1,unsentKey:"amplitude_unsent",unsentIdentifyKey:"amplitude_unsent_identify",uploadBatchSize:100,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","Cross-Origin-Resource-Policy":"cross-origin"},serverZone:pt,useDynamicConfig:!1,serverZoneBasedApi:!1,sessionId:null},vt=new(function(){function e(){return h(this,e),e.instance||(this.ingestionEndpoint=E,e.instance=this),e.instance}return f(e,[{key:"refresh",value:function(e,t,n){var i="https";t||"https:"===se.location.protocol||(i="http");var o=i+"://"+function(e){var t=w;switch(e){case lt:t=C;break;case pt:t=w}return t}(e),r=this;if(!!se.XDomainRequest){var s=new se.XDomainRequest;s.open("GET",o,!0),s.onload=function(){var e=JSON.parse(s.responseText);r.ingestionEndpoint=e.ingestionEndpoint,n&&n()},s.onerror=function(){},s.ontimeout=function(){},s.onprogress=function(){},s.send()}else{var a=new XMLHttpRequest;a.open("GET",o,!0),a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var e=JSON.parse(a.responseText);r.ingestionEndpoint=e.ingestionEndpoint,n&&n()}},a.send()}}}]),e}()),yt=function(e){(0,i.kP)()||Ee()||Se.warn("amplitude-js will not work in a non-browser environment. If you are planning to add Amplitude to a node environment, please use @amplitude/node"),this._instanceName=ke(e)?m:e.toLowerCase(),this._unsentEvents=[],this._unsentIdentifys=[],this._ua=new(u())(navigator.userAgent).getResult(),this.options=y({},ft,{trackingOptions:y({},ft.trackingOptions)}),this.cookieStorage=(new nt).getStorage(),this._q=[],this._sending=!1,this._updateScheduled=!1,this._onInitCallbacks=[],this._onNewSessionStartCallbacks=[],this._eventId=0,this._identifyId=0,this._lastEventTime=null,this._newSession=!1,this._sequenceNumber=0,this._sessionId=null,this._isInitialized=!1,this._connector=null,this._userAgent=navigator&&navigator.userAgent||null};yt.prototype.Identify=st,yt.prototype.Revenue=ut,yt.prototype.init=function(e,t,n,o){var r=this;if("string"!==ce(e)||ke(e))Se.error("Invalid apiKey. Please re-initialize with a valid apiKey");else try{this._connector=c.AnalyticsConnector.getInstance(this._instanceName),mt(this.options,n),((0,i.kP)()||Ee())&&void 0!==se.Prototype&&Array.prototype.toJSON&&((0,i.XQ)(),Se.warn("Prototype.js injected Array.prototype.toJSON. Deleting Array.prototype.toJSON to prevent double-stringify")),this.options.cookieName!==ft.cookieName&&Se.warn("The cookieName option is deprecated. We will be ignoring it for newer cookies"),this.options.serverZoneBasedApi&&(this.options.apiEndpoint=ht(this.options.serverZone)),this._refreshDynamicConfig(),this.options.apiKey=e,this._storageSuffix="_"+e+(this._instanceName===m?"":"_"+this._instanceName),this._storageSuffixV5=e.slice(0,6),this._oldCookiename=this.options.cookieName+this._storageSuffix,this._unsentKey=this.options.unsentKey+this._storageSuffix,this._unsentIdentifyKey=this.options.unsentIdentifyKey+this._storageSuffix,this._cookieName=j+"_"+this._storageSuffixV5,this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie}),this._metadataStorage=new ot({storageKey:this._cookieName,disableCookies:this.options.disableCookies,expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie,storage:this.options.storage});var s=!!this.cookieStorage.get(this._oldCookiename),a=!!this._metadataStorage.load();this._useOldCookie=!a&&s&&!this.options.cookieForceUpgrade;var u=a||s;if(this.options.domain=this.cookieStorage.options().domain,this.options.deferInitialization&&!u)return void this._deferInitialization(e,t,n,o);"string"===ce(this.options.logLevel)&&be(this.options.logLevel);var p=Ct(this);this._apiPropertiesTrackingOptions=Object.keys(p).length>0?{tracking_options:p}:{},this.options.cookieForceUpgrade&&s&&(a||It(this),this.cookieStorage.remove(this._oldCookiename)),_t(this),this._pendingReadStorage=!0;this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).map((function(e){return{event:e}})).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).map((function(e){return{event:e}})).concat(this._unsentIdentifys)),n&&n.onNewSessionStart&&this.onNewSessionStart(this.options.onNewSessionStart),function(e){n&&n.deviceId&&!De(n.deviceId)&&(Se.error('Invalid device ID rejected. Randomly generated UUID will be used instead of "'.concat(n.deviceId,'"')),delete n.deviceId),r.options.deviceId=r._getInitialDeviceId(n&&n.deviceId,e),r.options.userId="string"===ce(t)&&!ke(t)&&t||"number"===ce(t)&&t.toString()||r.options.userId||null;var i=(new Date).getTime(),o=!r._sessionId||!r._lastEventTime||i-r._lastEventTime>r.options.sessionTimeout||r.options.sessionId;o&&(r.options.unsetParamsReferrerOnNewSession&&r._unsetUTMParams(),r._newSession=!0,r._sessionId=r.options.sessionId||i,r.options.sessionId=void 0,r.options.saveParamsReferrerOncePerSession&&r._trackParamsAndReferrer()),r.options.saveParamsReferrerOncePerSession||r._trackParamsAndReferrer(),r.options.saveEvents&&(gt(r._unsentEvents),gt(r._unsentIdentifys)),r._lastEventTime=i,St(r),r._pendingReadStorage=!1,r._sendEventsIfReady();for(var s=0;s<r._onInitCallbacks.length;s++)r._onInitCallbacks[s](r);r._onInitCallbacks=[],r._isInitialized=!0,o&&r._runNewSessionStartCallbacks()}(),this.runQueuedFunctions(),"function"===ce(o)&&o(this);var l=this.options.onExitPage;if("function"===ce(l)&&!this.pageHandlersAdded){this.pageHandlersAdded=!0;se.addEventListener("pagehide",(function(){var e;e=r.options.transport,r.setTransport(ie),l(),r.setTransport(e)}),!1)}this._connector.eventBridge.setEventReceiver((function(e){r._logEvent(e.eventType,e.eventProperties,e.userProperties)}));var h=this._connector.identityStore.editIdentity();this.options.deviceId&&h.setDeviceId(this.options.deviceId),this.options.userId&&h.setUserId(this.options.userId),h.commit()}catch(d){Se.error(d),n&&"function"===ce(n.onError)&&n.onError(d)}},yt.prototype._runNewSessionStartCallbacks=function(){for(var e=0;e<this._onNewSessionStartCallbacks.length;e++)this._onNewSessionStartCallbacks[e](this)},yt.prototype.deleteLowerLevelDomainCookies=function(){var e=Be(),t=this.options.domain&&"."===this.options.domain[0]?this.options.domain.slice(1):this.options.domain;if(t&&Ee()&&e!==t&&new RegExp(t+"$").test(e)){for(var n=e.split("."),i=t.split("."),o=n.length;o>i.length;--o){var r=n.slice(n.length-o).join(".");Ke(this._cookieName,null,{domain:"."+r})}Ke(this._cookieName,null,{})}},yt.prototype._getInitialDeviceId=function(e,t){if(e)return e;if(this.options.deviceIdFromUrlParam){var n=this._getDeviceIdFromUrlParam(this._getUrlParams());if(n)return n}return this.options.deviceId?this.options.deviceId:t||Te()};var gt=function(e){for(var t=0;t<e.length;t++){var n=e[t].event.user_properties,i=e[t].event.event_properties,o=e[t].event.groups;e[t].event.user_properties=Ae(n),e[t].event.event_properties=Ae(i),e[t].event.groups=Ce(o)}};yt.prototype._trackParamsAndReferrer=function(){var e,t,n,i;if(this.options.includeUtm&&(e=this._initUtmData()),this.options.includeReferrer&&(t=this._saveReferrer(this._getReferrer())),this.options.includeGclid&&(n=this._saveGclid(this._getUrlParams())),this.options.includeFbclid&&(i=this._saveFbclid(this._getUrlParams())),this.options.logAttributionCapturedEvent){var o=y({},e,t,n,i);Object.keys(o).length>0&&this.logEvent(te,o)}};var mt=function e(t,n){if("object"===ce(n)){var i=new Set(["headers"]),o=function(i){if(Object.prototype.hasOwnProperty.call(t,i)){var o=n[i],r=ce(t[i]);("transport"!==i||Pe(o))&&("sessionId"!==i||null===o?Ne(o,i+" option",r)&&("boolean"===r?t[i]=!!o:"string"===r&&!ke(o)||"number"===r&&o>0||"function"===r?t[i]=o:"object"===r&&e(t[i],o)):t[i]=qe(o)?o:null)}};for(var r in n)i.has(r)?t[r]=y({},t[r],n[r]):Object.prototype.hasOwnProperty.call(n,r)&&o(r)}};yt.prototype.runQueuedFunctions=function(){var e=this._q;this._q=[];for(var t=0;t<e.length;t++){var n=this[e[t][0]];"function"===ce(n)&&n.apply(this,e[t].slice(1))}},yt.prototype._apiKeySet=function(e){return!ke(this.options.apiKey)||(Se.error("Invalid apiKey. Please set a valid apiKey with init() before calling "+e),!1)},yt.prototype._loadSavedUnsentEvents=function(e){var t=this._getFromStorage(tt,e),n=this._parseSavedUnsentEventsString(t,e);return this._setInStorage(tt,e,JSON.stringify(n)),n},yt.prototype._parseSavedUnsentEventsString=function(e,t){if(ke(e))return[];if("string"===ce(e))try{var n=JSON.parse(e);if("array"===ce(n))return n}catch(Rt){}return Se.error("Unable to load "+t+" events. Restart with a new empty queue."),[]},yt.prototype.isNewSession=function(){return this._newSession},yt.prototype.onInit=function(e){this._isInitialized?e(this):this._onInitCallbacks.push(e)},yt.prototype.onNewSessionStart=function(e){this._onNewSessionStartCallbacks.push(e)},yt.prototype.getSessionId=function(){return this._sessionId},yt.prototype.nextEventId=function(){return this._eventId++,this._eventId},yt.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},yt.prototype.nextSequenceNumber=function(){return this._sequenceNumber++,this._sequenceNumber},yt.prototype._unsentCount=function(){return this._unsentEvents.length+this._unsentIdentifys.length},yt.prototype._sendEventsIfReady=function(){return 0!==this._unsentCount()&&(this.options.batchEvents?this._unsentCount()>=this.options.eventUploadThreshold||this.options.transport===ie?(this.sendEvents(),!0):(this._updateScheduled||(this._updateScheduled=!0,setTimeout(function(){this._updateScheduled=!1,this.sendEvents()}.bind(this),this.options.eventUploadPeriodMillis)),!1):(this.sendEvents(),!0))},yt.prototype.clearStorage=function(){return this._metadataStorage.clear()},yt.prototype._getFromStorage=function(e,t){return e.getItem(t+this._storageSuffix)},yt.prototype._setInStorage=function(e,t,n){e.setItem(t+this._storageSuffix,n)};var _t=function(e){if(e._useOldCookie){var t=e.cookieStorage.get(e._oldCookiename);"object"!==ce(t)||bt(e,t)}else{var n=e._metadataStorage.load();"object"===ce(n)&&bt(e,n)}},It=function(e){var t=e.cookieStorage.get(e._oldCookiename);"object"===ce(t)&&(bt(e,t),St(e))},bt=function(e,t){t.deviceId&&(e.options.deviceId=t.deviceId),t.userId&&(e.options.userId=t.userId),null!==t.optOut&&void 0!==t.optOut&&!1!==t.optOut&&(e.options.optOut=t.optOut),t.sessionId&&(e._sessionId=parseInt(t.sessionId,10)),t.lastEventTime&&(e._lastEventTime=parseInt(t.lastEventTime,10)),t.eventId&&(e._eventId=parseInt(t.eventId,10)),t.identifyId&&(e._identifyId=parseInt(t.identifyId,10)),t.sequenceNumber&&(e._sequenceNumber=parseInt(t.sequenceNumber,10))},St=function(e){var t={deviceId:e.options.deviceId,userId:e.options.userId,optOut:e.options.optOut,sessionId:e._sessionId,lastEventTime:e._lastEventTime,eventId:e._eventId,identifyId:e._identifyId,sequenceNumber:e._sequenceNumber};e._useOldCookie?e.cookieStorage.set(e.options.cookieName+e._storageSuffix,t):e._metadataStorage.save(t)};yt.prototype._initUtmData=function(e,t){e=e||this._getUrlParams(),t=t||this.cookieStorage.get("__utmz");var n,i,o,r,s,a,u,c,p,l,h,d=(i=e,o=(n=t)?"?"+n.split(".").slice(-1)[0].replace(/\|/g,"&"):"",r=function(e,t,n,i){return Oe(e,t)||Oe(n,i)},s=r(X,i,"utmcsr",o),a=r(H,i,"utmcmd",o),u=r(Q,i,"utmccn",o),c=r(Y,i,"utmctr",o),p=r(ee,i,"utmcct",o),l={},(h=function(e,t){ke(t)||(l[e]=t)})(X,s),h(H,a),h(Q,u),h(Y,c),h(ee,p),l);return kt(this,d),d},yt.prototype._unsetUTMParams=function(){var e=new st;e.unset(Z),e.unset(X),e.unset(H),e.unset(Q),e.unset(Y),e.unset(ee),this.identify(e)};var kt=function(e,t){if("object"===ce(t)&&0!==Object.keys(t).length){var n=new st;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n.setOnce("initial_"+i,t[i]),n.set(i,t[i]));e.identify(n)}};yt.prototype._getReferrer=function(){return"undefined"!=typeof document?document.referrer:""},yt.prototype._getUrlParams=function(){return se.location.search},yt.prototype._saveGclid=function(e){var t=Oe("gclid",e);if(!ke(t)){var n={gclid:t};return kt(this,n),n}},yt.prototype._saveFbclid=function(e){var t=Oe("fbclid",e);if(!ke(t)){var n={fbclid:t};return kt(this,n),n}},yt.prototype._getDeviceIdFromUrlParam=function(e){return Oe(V,e)},yt.prototype._getReferringDomain=function(e){if(ke(e))return null;var t=e.split("/");return t.length>=3?t[2]:null},yt.prototype._saveReferrer=function(e){if(!ke(e)){var t={referrer:e,referring_domain:this._getReferringDomain(e)};return kt(this,t),t}},yt.prototype.saveEvents=function(){try{var e=JSON.stringify(this._unsentEvents.map((function(e){return e.event})));this._setInStorage(tt,this.options.unsentKey,e)}catch(Rt){}try{var t=JSON.stringify(this._unsentIdentifys.map((function(e){return e.event})));this._setInStorage(tt,this.options.unsentIdentifyKey,t)}catch(Rt){}},yt.prototype.setDomain=function(e){if(this._shouldDeferCall())return this._q.push(["setDomain"].concat(Array.prototype.slice.call(arguments,0)));if(Ne(e,"domain","string"))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:e,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,_t(this),St(this)}catch(Rt){Se.error(Rt)}},yt.prototype.setUserId=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Ne(t,"startNewSession","boolean")){if(this._shouldDeferCall())return this._q.push(["setUserId"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.userId=null!=e&&""+e||null,t&&(this.options.unsetParamsReferrerOnNewSession&&this._unsetUTMParams(),this._newSession=!0,this._sessionId=(new Date).getTime(),this._runNewSessionStartCallbacks(),this.options.saveParamsReferrerOncePerSession&&this._trackParamsAndReferrer()),St(this),this._connector&&this._connector.identityStore.editIdentity().setUserId(this.options.userId).commit()}catch(Rt){Se.error(Rt)}}},yt.prototype.setGroup=function(e,t){if(this._shouldDeferCall())return this._q.push(["setGroup"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("setGroup()")&&Ne(e,"groupType","string")&&!ke(e)){var n={};n[e]=t;var i=(new st).set(e,t);this._logEvent(S,null,null,i.userPropertiesOperations,n,null,null,null)}},yt.prototype.setOptOut=function(e){if(this._shouldDeferCall())return this._q.push(["setOptOut"].concat(Array.prototype.slice.call(arguments,0)));if(Ne(e,"enable","boolean"))try{this.options.optOut=e,St(this)}catch(Rt){Se.error(Rt)}},yt.prototype.setSessionId=function(e){if(Ne(e,"sessionId","number"))try{this._sessionId=e,St(this)}catch(Rt){Se.error(Rt)}},yt.prototype.resetSessionId=function(){this.setSessionId((new Date).getTime())},yt.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push(["regenerateDeviceId"].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(Te())},yt.prototype.setDeviceId=function(e){if(this._shouldDeferCall())return this._q.push(["setDeviceId"].concat(Array.prototype.slice.call(arguments,0)));if(De(e))try{ke(e)||(this.options.deviceId=""+e,St(this),this._connector&&this._connector.identityStore.editIdentity().setDeviceId(this.options.deviceId).commit())}catch(Rt){Se.error(Rt)}},yt.prototype.setTransport=function(e){if(this._shouldDeferCall())return this._q.push(["setTransport"].concat(Array.prototype.slice.call(arguments,0)));Pe(e)&&(this.options.transport=e)},yt.prototype.setUserProperties=function(e){if(this._shouldDeferCall())return this._q.push(["setUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("setUserProperties()")&&Ne(e,"userProperties","object")){var t=we(Ae(e));if(0!==Object.keys(t).length){var n=new st;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.set(i,t[i]);this.identify(n)}}},yt.prototype.clearUserProperties=function(){if(this._shouldDeferCall())return this._q.push(["clearUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("clearUserProperties()")){var e=new st;e.clearAll(),this.identify(e)}};var Et=function(e,t){for(var n=0;n<t._q.length;n++){var i=e[t._q[n][0]];"function"===ce(i)&&i.apply(e,t._q[n].slice(1))}return e};yt.prototype.identify=function(e,t,n,i){if(this._shouldDeferCall())return this._q.push(["identify"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("identify()"))if("object"===ce(e)&&Object.prototype.hasOwnProperty.call(e,"_q")&&(e=Et(new st,e)),e instanceof st){if(Object.keys(e.userPropertiesOperations).length>0)return this._logEvent(S,null,null,e.userPropertiesOperations,null,null,null,t,n,i);At(t,n,0,"No request sent",{reason:"No user property operations"})}else Se.error("Invalid identify input type. Expected Identify object but saw "+ce(e)),At(t,n,0,"No request sent",{reason:"Invalid identify input type"});else At(t,n,0,"No request sent",{reason:"API key is not set"})},yt.prototype.groupIdentify=function(e,t,n,i,o,r){if(this._shouldDeferCall())return this._q.push(["groupIdentify"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("groupIdentify()"))if(Ne(e,"group_type","string")&&!ke(e))if(null!=t)if("object"===ce(n)&&Object.prototype.hasOwnProperty.call(n,"_q")&&(n=Et(new st,n)),n instanceof st){if(Object.keys(n.userPropertiesOperations).length>0)return this._logEvent(k,null,null,null,v({},e,t),n.userPropertiesOperations,null,i,o,r);At(i,o,0,"No request sent",{reason:"No group property operations"})}else Se.error("Invalid identify input type. Expected Identify object but saw "+ce(n)),At(i,o,0,"No request sent",{reason:"Invalid identify input type"});else At(i,o,0,"No request sent",{reason:"Invalid group name"});else At(i,o,0,"No request sent",{reason:"Invalid group type"});else At(i,o,0,"No request sent",{reason:"API key is not set"})},yt.prototype.setVersionName=function(e){if(this._shouldDeferCall())return this._q.push(["setVersionName"].concat(Array.prototype.slice.call(arguments,0)));Ne(e,"versionName","string")&&(this.options.versionName=e)},yt.prototype._logEvent=function(e,t,n,i,o,r,s,a,u,c){if(_t(this),e)if(this.options.optOut)At(a,u,0,"No request sent",{reason:"optOut is set to true"});else try{var p;p=e===S||e===k?this.nextIdentifyId():this.nextEventId();var l=this.nextSequenceNumber(),h="number"===ce(s)?s:(new Date).getTime();c?this._sessionId=-1:(!this._sessionId||!this._lastEventTime||h-this._lastEventTime>this.options.sessionTimeout)&&(this._sessionId=h,this._runNewSessionStartCallbacks()),this._lastEventTime=h,St(this);var d=this._ua.browser.name,f=this._ua.browser.major,v=this._ua.device.model||this._ua.os.name,g=this._ua.device.vendor;i=i||{};var m=y({},this._apiPropertiesTrackingOptions);n=y({},n||{},m),t=t||{},o=o||{},r=r||{};var _={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:h,event_id:p,session_id:this._sessionId||-1,event_type:e,version_name:this.options.versionName||null,platform:wt(this,"platform")?this.options.platform:null,os_name:wt(this,"os_name")&&d||null,os_version:wt(this,"os_version")&&f||null,device_model:wt(this,"device_model")&&v||null,device_manufacturer:wt(this,"device_manufacturer")&&g||null,language:wt(this,"language")?this.options.language:null,api_properties:n,event_properties:we(Ae(t)),user_properties:we(Ae(i)),uuid:ct(),library:this.options.library,sequence_number:l,groups:we(Ce(o)),group_properties:we(Ae(r)),user_agent:this._userAgent};return Ot(this)&&(_.plan={branch:this.options.plan.branch||void 0,source:this.options.plan.source||void 0,version:this.options.plan.version||void 0}),e===S||e===k?(this._unsentIdentifys.push({event:_,callback:a,errorCallback:u}),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push({event:_,callback:a,errorCallback:u}),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),this._sendEventsIfReady(),e===S&&this._connector&&this._connector.identityStore.editIdentity().updateUserProperties(we(Ae(i))).commit(),p}catch(Rt){Se.error(Rt)}else At(a,u,0,"No request sent",{reason:"Missing eventType"})};var Ot=function(e){return e.options.plan&&(e.options.plan.source||e.options.plan.branch||e.options.plan.version)},wt=function(e,t){return!!e.options.trackingOptions[t]},Ct=function(e){for(var t=["city","country","dma","ip_address","region"],n={},i=0;i<t.length;i++){var o=t[i];wt(e,o)||(n[o]=!1)}return n};yt.prototype._limitEventsQueued=function(e){e.length>this.options.savedMaxCount&&e.splice(0,e.length-this.options.savedMaxCount).forEach((function(e){At(e.callback,e.errorCallback,0,"No request sent",{reason:"Event dropped because options.savedMaxCount exceeded. User may be offline or have a content blocker"})}))},yt.prototype.logEvent=function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this._shouldDeferCall()?this._q.push(["logEvent"].concat(Array.prototype.slice.call(arguments,0))):this.logEventWithTimestamp(e,t,null,n,i,o)},yt.prototype.logEventWithTimestamp=function(e,t,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithTimestamp"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEvent()")?Ne(e,"eventType","string")?ke(e)?(At(i,o,0,"No request sent",{reason:"Missing eventType"}),-1):(Ne(r,"outOfSession","boolean")||At(i,o,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(e,t,null,null,null,null,n,i,o,r)):(At(i,o,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(At(i,o,0,"No request sent",{reason:"API key not set"}),-1)},yt.prototype.logEventWithGroups=function(e,t,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithGroups"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEventWithGroups()")?Ne(e,"eventType","string")?(Ne(r,"outOfSession","boolean")||At(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(e,t,null,null,n,null,null,i,o,r)):(At(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(At(event.callback,event.errorCallback,0,"No request sent",{reason:"API key not set"}),-1)};var Nt=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},At=function(e,t,n,i,o){"function"===ce(e)&&e(n,i,o),"function"===ce(t)&&t(n,i,o)};yt.prototype.logRevenueV2=function(e){if(this._shouldDeferCall())return this._q.push(["logRevenueV2"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("logRevenueV2()"))if("object"===ce(e)&&Object.prototype.hasOwnProperty.call(e,"_q")&&(e=Et(new ut,e)),e instanceof ut){if(e&&e._isValidRevenue())return this.logEvent(B,e._toJSONObject())}else Se.error("Invalid revenue input type. Expected Revenue object but saw "+ce(e))},yt.prototype.logRevenue=function(e,t,n){return this._shouldDeferCall()?this._q.push(["logRevenue"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logRevenue()")&&Nt(e)&&(void 0===t||Nt(t))?this._logEvent(B,{},{productId:n,special:"revenue_amount",quantity:t||1,price:e},null,null,null,null,null):-1},yt.prototype._logErrorsOnEvents=function(e,t,n,i){for(var o=["_unsentEvents","_unsentIdentifys"],r=0;r<o.length;r++)for(var s=o[r],a="_unsentEvents"===s?e:t,u=0;u<this[s].length;u++){var c=this[s][u];c.event.event_id<=a&&c.errorCallback&&c.errorCallback(n,i)}},yt.prototype.removeEvents=function(e,t,n,i){Dt(this,"_unsentEvents",e,n,i),Dt(this,"_unsentIdentifys",t,n,i)};var Dt=function(e,t,n,i,o){if(!(n<0)){for(var r=[],s=0;s<e[t].length;s++){var a=e[t][s];a.event.event_id>n?r.push(a):a.callback&&a.callback(i,o)}e[t]=r}};yt.prototype.sendEvents=function(){if(this._apiKeySet("sendEvents()")){if(this.options.optOut)this.removeEvents(1/0,1/0,0,"No request sent",{reason:"Opt out is set to true"});else if(0!==this._unsentCount()){if(this.options.transport!==ie){if(this._sending)return;this._sending=!0}var e=(this.options.forceHttps||"https:"===se.location.protocol?"https":"http")+"://"+this.options.apiEndpoint,t=Math.min(this._unsentCount(),this.options.uploadBatchSize),n=this._mergeEventsAndIdentifys(t),i=n.maxEventId,o=n.maxIdentifyId,s=JSON.stringify(n.eventsToSend.map((function(e){return e.event}))),a=(new Date).getTime(),u={client:this.options.apiKey,e:s,v:_,upload_time:a,checksum:r()(_+this.options.apiKey+s+a)};if(this.options.transport!==ie){var c=this;try{new at(e,u,this.options.headers).send((function(e,n){c._sending=!1;try{200===e&&"success"===n?(c.removeEvents(i,o,e,n),c.options.saveEvents&&c.saveEvents(),c._sendEventsIfReady()):(c._logErrorsOnEvents(i,o,e,n),413===e&&(1===c.options.uploadBatchSize&&c.removeEvents(i,o,e,n),c.options.uploadBatchSize=Math.ceil(t/2),c.sendEvents()))}catch(Rt){}}))}catch(Rt){var p="Request failed to send";Se.error(p),c._logErrorsOnEvents(i,o,0,p),c.removeEvents(i,o,0,p,{reason:Rt.message})}}else{navigator.sendBeacon(e,new URLSearchParams(u))?(this.removeEvents(i,o,200,"success"),this.options.saveEvents&&this.saveEvents()):this._logErrorsOnEvents(i,o,0,"")}}}else this.removeEvents(1/0,1/0,0,"No request sent",{reason:"API key not set"})},yt.prototype._mergeEventsAndIdentifys=function(e){for(var t=[],n=0,i=-1,o=0,r=-1;t.length<e;){var s=void 0,a=o>=this._unsentIdentifys.length,u=n>=this._unsentEvents.length;if(u&&a){Se.error("Merging Events and Identifys, less events and identifys than expected");break}a?i=(s=this._unsentEvents[n++]).event.event_id:u?r=(s=this._unsentIdentifys[o++]).event.event_id:!("sequence_number"in this._unsentEvents[n].event)||this._unsentEvents[n].event.sequence_number<this._unsentIdentifys[o].event.sequence_number?i=(s=this._unsentEvents[n++]).event.event_id:r=(s=this._unsentIdentifys[o++]).event.event_id,t.push(s)}return{eventsToSend:t,maxEventId:i,maxIdentifyId:r}},yt.prototype.setGlobalUserProperties=function(e){this.setUserProperties(e)},yt.prototype.__VERSION__=function(){return this.options.library.version},yt.prototype.setLibrary=function(e,t){null!=e&&(this.options.library.name=e),null!=t&&(this.options.library.version=t)},yt.prototype._shouldDeferCall=function(){return this._pendingReadStorage||this._initializationDeferred},yt.prototype._deferInitialization=function(){this._initializationDeferred=!0,this._q.push(["init"].concat(Array.prototype.slice.call(arguments,0)))},yt.prototype.enableTracking=function(){this._initializationDeferred=!1,St(this),this.runQueuedFunctions()},yt.prototype._refreshDynamicConfig=function(){this.options.useDynamicConfig&&vt.refresh(this.options.serverZone,this.options.forceHttps,function(){this.options.apiEndpoint=vt.ingestionEndpoint}.bind(this))},yt.prototype.getDeviceId=function(){return this.options.deviceId},yt.prototype.getUserId=function(){return this.options.userId},yt.prototype.setMinTimeBetweenSessionsMillis=function(e){if(Ne(e,"timeInMillis","number")){if(this._shouldDeferCall())return this._q.push(["setMinTimeBetweenSessionsMillis"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.sessionTimeout=e}catch(Rt){Se.error(Rt)}}},yt.prototype.setEventUploadThreshold=function(e){if(Ne(e,"eventUploadThreshold","number")){if(this._shouldDeferCall())return this._q.push(["setEventUploadThreshold"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.eventUploadThreshold=e}catch(Rt){Se.error(Rt)}}},yt.prototype.setUseDynamicConfig=function(e){if(Ne(e,"useDynamicConfig","boolean")){if(this._shouldDeferCall())return this._q.push(["setUseDynamicConfig"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.useDynamicConfig=e,this._refreshDynamicConfig()}catch(Rt){Se.error(Rt)}}},yt.prototype.setServerZone=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((e===lt||e===pt)&&Ne(t,"serverZoneBasedApi","boolean")){if(this._shouldDeferCall())return this._q.push(["setServerZone"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.serverZone=e,this.options.serverZoneBasedApi=t,t&&(this.options.apiEndpoint=ht(this.options.serverZone))}catch(Rt){Se.error(Rt)}}},yt.prototype.setServerUrl=function(e){if(Ne(e,"serverUrl","string")){if(this._shouldDeferCall())return this._q.push(["setServerUrl"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.apiEndpoint=e}catch(Rt){Se.error(Rt)}}};var Pt=function(){this.options=y({},ft),this._q=[],this._instances={}};Pt.prototype.Identify=st,Pt.prototype.Revenue=ut,Pt.prototype.getInstance=function(e){e=ke(e)?m:e.toLowerCase();var t=this._instances[e];return void 0===t&&(t=new yt(e),this._instances[e]=t),t},Pt.prototype.init=function(e,t,n,i){this.getInstance().init(e,t,n,function(e){this.options=e.options,"function"===ce(i)&&i(e)}.bind(this))},Pt.prototype.isNewSession=function(){return this.getInstance().isNewSession()},Pt.prototype.getSessionId=function(){return this.getInstance().getSessionId()},Pt.prototype.nextEventId=function(){return this.getInstance().nextEventId()},Pt.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},Pt.prototype.nextSequenceNumber=function(){return this.getInstance().nextSequenceNumber()},Pt.prototype.saveEvents=function(){this.getInstance().saveEvents()},Pt.prototype.setDomain=function(e){this.getInstance().setDomain(e)},Pt.prototype.setUserId=function(e){this.getInstance().setUserId(e)},Pt.prototype.setGroup=function(e,t){this.getInstance().setGroup(e,t)},Pt.prototype.setOptOut=function(e){this.getInstance().setOptOut(e)},Pt.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},Pt.prototype.setDeviceId=function(e){this.getInstance().setDeviceId(e)},Pt.prototype.setUserProperties=function(e){this.getInstance().setUserProperties(e)},Pt.prototype.clearUserProperties=function(){this.getInstance().clearUserProperties()},Pt.prototype.identify=function(e,t){this.getInstance().identify(e,t)},Pt.prototype.setVersionName=function(e){this.getInstance().setVersionName(e)},Pt.prototype.logEvent=function(e,t,n){return this.getInstance().logEvent(e,t,n)},Pt.prototype.logEventWithGroups=function(e,t,n,i){return this.getInstance().logEventWithGroups(e,t,n,i)},Pt.prototype.logRevenueV2=function(e){return this.getInstance().logRevenueV2(e)},Pt.prototype.logRevenue=function(e,t,n){return this.getInstance().logRevenue(e,t,n)},Pt.prototype.removeEvents=function(e,t){this.getInstance().removeEvents(e,t)},Pt.prototype.sendEvents=function(e){this.getInstance().sendEvents(e)},Pt.prototype.setGlobalUserProperties=function(e){this.getInstance().setUserProperties(e)},Pt.prototype.__VERSION__=dt;var qt=void 0!==se&&se.amplitude||{},xt=new Pt;for(var Tt in xt._q=qt._q||[],qt._iq)Object.prototype.hasOwnProperty.call(qt._iq,Tt)&&(xt.getInstance(Tt)._q=qt._iq[Tt]._q||[])}}]);
//# sourceMappingURL=3bf748c2-eec99be23edfd0df8d9e.js.map